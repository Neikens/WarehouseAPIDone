# =============================================================================
# TESTU KONFIGUR?CIJAS FAILS
# ?is fails tiek izmantots testu izpildei ar H2 iegulto datub?zi
# =============================================================================

# -----------------------------------------------------------------------------
# H2 DATUB?ZES KONFIGUR?CIJA TESTIEM
# -----------------------------------------------------------------------------
# Izmanto atmi?? eso?u H2 datub?zi, kas tiek izveidota katram testa palai?anas reizei
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driver-class-name=org.h2.Driver

# -----------------------------------------------------------------------------
# JPA UN HIBERNATE KONFIGUR?CIJA
# -----------------------------------------------------------------------------
# Autom?tiski izveido un dz?? tabulas katram testa ciklam
spring.jpa.hibernate.ddl-auto=create-drop
# R?da SQL vaic?jumus konsole (noder?gi atk??do?anai)
spring.jpa.show-sql=true
# Format? SQL vaic?jumus lab?kai las?m?bai
spring.jpa.properties.hibernate.format_sql=true
# Nor?da H2 datub?zes dialektu
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
# Atsl?dz "Open Session in View" paternu (lab?ka veiktsp?ja)
spring.jpa.open-in-view=false

# -----------------------------------------------------------------------------
# FLYWAY MIGR?CIJU ATSL?G?ANA
# -----------------------------------------------------------------------------
# Atsl?dz Flyway migr?cijas testiem (izmanto Hibernate DDL)
spring.flyway.enabled=false

# -----------------------------------------------------------------------------
# DRO??BAS KONFIGUR?CIJA TESTIEM
# -----------------------------------------------------------------------------
# Noklus?juma admin lietot?js testiem
spring.security.user.name=admin
spring.security.user.password=admin123
spring.security.user.roles=ADMIN,USER

# -----------------------------------------------------------------------------
# ?URN?L??ANAS KONFIGUR?CIJA
# -----------------------------------------------------------------------------
# SQL vaic?jumu ?urn?l??ana
logging.level.org.hibernate.SQL=DEBUG
# SQL parametru ?urn?l??ana
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
# Spring Test framework ?urn?l??ana
logging.level.org.springframework.test=DEBUG
# Spring Security ?urn?l??ana
logging.level.org.springframework.security=DEBUG
# Warehouse API ?urn?l??ana
logging.level.com.warehouse.api=DEBUG

# -----------------------------------------------------------------------------
# SPRING BOOT TESTU SPECIFISK?S KONFIGUR?CIJAS
# -----------------------------------------------------------------------------
# At?auj bean defin?ciju p?rrakst??anu (noder?gi mock objektiem)
spring.main.allow-bean-definition-overriding=true
# Iesl?dz lazy inicializ?ciju (?tr?ka testu start??ana)
spring.main.lazy-initialization=true
# Izmanto nejau?u portu testiem (izvair?s no konflikta)
server.port=0

# -----------------------------------------------------------------------------
# ACTUATOR ENDPOINTS TESTIEM
# -----------------------------------------------------------------------------
# Atver visus actuator endpoints testiem
management.endpoints.web.exposure.include=*
# R?da detaliz?tu health inform?ciju
management.endpoint.health.show-details=always

# -----------------------------------------------------------------------------
# OPENAPI/SWAGGER KONFIGUR?CIJA
# -----------------------------------------------------------------------------
# API dokument?cijas ce??
springdoc.api-docs.path=/api-docs
# Swagger UI ce??
springdoc.swagger-ui.path=/swagger-ui.html
# Atsl?dz Swagger UI testiem (nav nepiecie?ams)
springdoc.swagger-ui.enabled=false

# -----------------------------------------------------------------------------
# JACKSON JSON KONFIGUR?CIJA
# -----------------------------------------------------------------------------
# Format? JSON atbildes (lab?ka las?m?ba testiem)
spring.jackson.serialization.indent-output=true
# Ignor? nezin?mas ?pa??bas
spring.jackson.deserialization.fail-on-unknown-properties=false

# -----------------------------------------------------------------------------
# TESTU VEIKTSP?JAS OPTIMIZ?CIJA
# -----------------------------------------------------------------------------
# Samazina connection pool izm?ru testiem
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
# ?tr?ka datub?zes savienojuma p?rbaude
spring.datasource.hikari.connection-test-query=SELECT 1